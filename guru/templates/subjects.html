{% extends 'base.html' %}
{% load static %}
{% block title %} Home view {% endblock %}
{% load crispy_forms_tags %}
{% block content %}
<div class="container-fluid m-2">
	<center><img src="{{ classroom.classroom_pic.url }}" style="height:20vw;" class="d-block w-50"></center>
	<div id="vue-container">

		<center id="homepage-btn-group">

			<button @click="toggleSubjects">
				Subjects
			</button>

			<a href="{% url 'polls' classroom.unique_id %}">
				Polls
			</a>
			<a href="/classroom/{{classroom.unique_id}}/">
				Classroom
			</a>
			<button @click="toggleMembers">Members 
				{% if pending_members %}
					{{pending_members|length}}
				{% endif %}
			</button>

			{% if form %}
				<button @click="addSubject"> Add </button><br>
			{% endif %}

			{% if message %}
				<p style="color:red;" v-if="subjects" > {{ message }} </p>
			{% endif %}

			{% if form %}
				<form v-if="addform" action="/guru/{{classroom.unique_id}}/" 
					method="POST" enctype="multipart/form-data">
					{% csrf_token %}

					<input type="text" name="subject_name" placeholder="Add a subject."
						 maxlength="50" required id="id_subject_name">
					<input type="text" name="teacher" placeholder="username of teacher.">
					<input type="submit" value="submit">
				</form>
			{% endif %}

		</center>
		<!-- Subjects -->


		<div v-if="subjects" class="row">

			{% for subject in subjects %}
			<div class="col-xs-12 col-md-6 col-lg-4">

				<div style="background:url('/media/bga.jpg');background-size:cover;background-position:center;"
					id="card" class="card"> 
					{% if subject %}
					<a class="text-center" id="class-link"
						href="{% url 'resources' classroom.unique_id subject.id  %}">

						<div id="subject-name">
							{{ subject|upper }} by {{subject.teacher }}
						</div>

					</a>
					{% endif %}
				</div>

			</div>
			{% endfor %}

		</div>

		<div v-if="members">

			{% if is_teacher %}
				{% if pending_members %}
					<center><h1 style="color:green">Pending members</h1></center>
				{% endif %}

				{% for member in pending_members %}
					<div class="row">
						<div class="member-card">
							<div class="wrapper">
								<br/>
								
								<div class="opts">
									<div class="dropdown">
										<div class="dropbtn">...</div>
										<div class="dropdown-content">
											<a href="{% url 'delete_request' classroom.unique_id member.username %}">
												Delete request
											</a>
											<a href="{% url 'accept_request' classroom.unique_id member.username %}">
												Accept request
											</a>
										</div>
									</div>
								</div>

								<img src="{{member.profile.profile_pic.url}}">
								<div class="member-container">
									<h4><b>{{ member.username }} &nbsp; &nbsp;</b></h4>
									<p>{{member.profile.bio}}</p>
								</div>

							</div>
						</div>
					</div>
				{% endfor %} 
			{% endif %}

			{% for teacher in teachers %}
			<div class="row">
				<div class="member-card">
					<div class="wrapper"><br/>
						{% if is_teacher %}
						<div class="opts">
							<div class="dropdown">
								<div class="dropbtn">...</div>
								<div class="dropdown-content">

									<a href="{% url 'remove_member' classroom.unique_id teacher.username %}">
										Remove from classroom
									</a>
									<a href="{% url 'remove_admin' classroom.unique_id teacher.username %}">
										Remove from teacher position
									</a>

								</div>
							</div>
						</div>
						{% endif %}
					</div>
					<img src="{{teacher.profile.profile_pic.url}}">
					<div class="member-container">
						<h4><b>{{ teacher.username }} &nbsp; &nbsp; <span style="float:right;color:green;">Teacher</span></b></h4>
						<p style="word-wrap: wrap;">{{teacher.profile.bio}}</p>
					</div>
				</div>
				{% endfor %}

			{% for student in students %}
			<div class="row">
				<div class="member-card">
					<div class="wrapper">
						<br/>
						
						<div class="opts">
							<div class="dropdown">
								<div class="dropbtn">...</div>
								<div class="dropdown-content">
									{% if is_teacher %}
									<a href="{% url 'remove_member' classroom.unique_id student.username %}">
										Remove from classroom
									</a>
									<a href="{% url 'make_admin' classroom.unique_id student.username %}">
										Make Teacher
									</a>
									{% else %}
										{% if user.username == student.username %}
											<a href="{% url 'remove_member' classroom.unique_id user.username %}">
											 Leave classroom
											</a>
										{% endif %}
									{% endif %}
								</div>
							</div>
						</div>
					</div>
					<img src="{{student.profile.profile_pic.url}}">
					<div class="member-container">
						<h4>	
							<b>
								{{ student.username }} &nbsp; &nbsp;
							</b>
						</h4>
						<p>
							{{student.profile.bio}}
						</p>
					</div>
				</div>
				{% endfor %}
			</div>
		</div>
		<!-- Subjects end  -->
	</div>
{% endblock %}