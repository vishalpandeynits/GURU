{% extends 'subject_page.html' %}
{% load crispy_forms_tags %}
{% block subject_content %}
{% load humanize %}
{% load comments %}
<div class="container" id="con">
	<div class="row">
		<div class="col">
			<a class="btn btn-danger m-2 float-right" href="{% url 'delete_resource' classroom.unique_id subject.id note.id %}" >Delete <i class="fa fa-trash" aria-hidden="true"></i> </a>
		<!-- Button trigger modal -->
		<a class="btn btn-primary m-2 float-right" data-toggle="modal" data-target="#updateresource">
		 Update <i class="fas fa-edit"></i></i>
		</a>
		<!-- Modal -->
		<div class="modal fade " id="updateresource" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
		  <div class="modal-dialog" role="document">
		    <div class="modal-content bg-info">

		      <div class="modal-header">
		        <h5 class="modal-title" id="exampleModalLabel">Update</h5>
		        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
		          <span aria-hidden="true">&times;</span>
		        </button>
		      </div>

		      <div class="modal-body">
			  <form method="POST" enctype="multipart/form-data">{% csrf_token %}
				{{ updateform|crispy }}
				<input type="submit" class="btn btn-primary float-right"value="submit">
			  </form>
		      </div>

		    </div>
		  </div>
		</div>
			{{note.topic}}<br><br>
			{% if note.file %}
			<a href="{{note.file.url}}" download>Download file </a><br>
			{% endif %}
			{{ note.description|safe }}
			<br><br><br>
		{% get_comment_count for note as comment_count %}
			{{ comment_count }} Comments
		<p style="font-size:1.3em;"> Class comment </p>
		{% if user.is_authenticated %}
		    {% get_comment_form for note as form %} 
		    <form action="{% comment_form_target %}" method="POST">
		    {% csrf_token %}
		    <textarea name="comment" style="width:100%;resize:none;" rows="4" maxlength="3000" v-model="comment" required id="id_comment"></textarea>
		    {% if form.name == "honeypot" %} style="display:none;" {% endif %}
		    {{ form.content_type }}
		    {{ form.object_pk }}
		    {{ form.timestamp }}
		    {{ form.security_hash }}
		    <input type="hidden" name="next" value="{% url 'read_note' classroom.unique_id subject.id note.id %}" />
		    <input type="submit" :disabled="disable" style="width:130px;" class="btn btn-primary  float-right" value="Add comment" id="id_submit" />
		    </form>
		{% endif %}
		<br><br>
		<!-- {% render_comment_list for note %} -->
		</div>
	</div>
</div>

{% endblock %}