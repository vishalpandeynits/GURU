{% extends 'base.html' %}
{% load crispy_forms_tags %}
{% block content %}
<div>
	{% include 'navigation.html' %}

    {% if messages %}
        <div class="messages container">
            {% for message in messages %}
                <div class='alert alert-{{ message.tags }} alert-dismissible fade show'>
                    {{ message }} 
                      <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                      </button>
                </div>
            {% endfor %}
        </div>
    {% endif %}
	
	<div id="profile" class="container">

		<div class="row">

			<div id="info" class="mx-auto">

				<img style="width:100%;height: 300px;" class="img-fluid" 
					src="{{ profile.profile_pic.url }}"><br><br>

				<h3 style="text-align:center;">{{ profile.user.username }}</h3>

				<pre style="text-align:center;">{{ profile.bio }}</pre>

				<div id="social-container"  style="display:flex; justify-content: center;">

					{% if profile.facebook %}

						<a style="background:#3b5998"href="{{ profile.facebook }}" target="_blank" 
							class="btn-floating btn-lg btn-fb">
							<i class="fab fa-facebook-f"></i>
							
						</a>
					{% endif %}

					<a href="mailto:{{profile.user.email}}" target="_blank" 
						class="btn-floating btn-lg btn-gplus">
						<i class="fas fa-envelope"></i>
					</a>

					{% if profile.whatsapp_number != None %}

						<a target="_blank" class="btn-floating btn-lg btn-whatsapp" 
							href="https://api.whatsapp.com/send?phone={{user.profile.whatsapp_number}}">
							<i class="fab fa-whatsapp"></i>
						</a>

					{% endif %}

					{% if profile.phone_number  != None %}

						<a target="_blank" href="tel:{{user.profile.phone_number }}" 
							class="btn-floating btn-lg">
							<i style="transform: rotate(270deg)"class="fa fa-phone" aria-hidden="true"></i>
						</a>

					{% endif %}
				</div>

			</div>

		</div>

		{% if profile.user.username == user.username %}

			<center>

				<button style="margin:10px;"class="btn btn-info"
					onclick="on(document.getElementsByClassName('overlay')[0])">
					Edit profile
				</button><br>

				{% if user.username == profile.user.username %}

					{% if not user.profile.whatsapp_number or not user.profile.facebook or not user.profile.phone_number %}

						Please add your contact details so other users can contact you in case of any need.

					{% endif %}

				{% endif %}

			</center>

			<div class="overlay">
				<form method="POST" id="profileupdateform" class=" overlayform" enctype="multipart/form-data"> 
					{% csrf_token %}
					<a onclick = "toggleBlockForm(document.getElementsByClassName('overlay')[0])" id="close"> &times;</a> 
					{{ p_form|crispy }}
					<button class="btn btn-primary" type="submit">Update</button>
				</form>
			</div>

		{% endif %}

	</div>
</div>
{% endblock %}
